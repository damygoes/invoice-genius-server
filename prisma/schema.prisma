generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("PROD_DATABASE_URL")
}

model User {
  id                  String                 @id @default(cuid())
  firstName           String
  lastName            String
  username            String?
  email               String                 @unique
  phone               String?
  mobile              String?
  profilePicture      String?
  address             String?
  userType            UserType               @default(private)
  selectedServices    Services[]
  onboarded           Boolean                @default(false)
  createdAt           DateTime               @default(now())
  updatedAt           DateTime               @updatedAt
  businessUserProfile BusinessUserProfile?
  RefreshTokens       RefreshToken[]
  subscriptions       SubscriptionsService[]
}

model BusinessUserProfile {
  id              String   @id @default(cuid())
  userId          String   @unique
  businessName    String
  businessLogo    String?
  businessWebsite String?
  businessInfo    String?
  businessEmail   String
  businessPhone   String?
  businessMobile  String?
  industry        String
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  businessAddress Json
  user            User     @relation(fields: [userId], references: [id])
}

model SubscriptionsService {
  id                   String             @id @default(cuid())
  userId               String
  subscriptionName     String
  subscriptionCategory String
  recurringInterval    RecurringInterval?
  subscribedOn         DateTime
  expiresOn            DateTime
  setReminder          Boolean            @default(false)
  reminderPeriod       DateTime?
  createdAt            DateTime           @default(now())
  updatedAt            DateTime           @updatedAt
  user                 User               @relation(fields: [userId], references: [id])

  @@index([userId])
}

model OTPStore {
  id            String    @id @default(cuid())
  email         String    @unique
  otp           String?
  createdAt     DateTime  @default(now())
  otpExpiration DateTime?
}

model RefreshToken {
  id        String   @id @default(cuid())
  token     String   @unique
  expiresAt DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  userEmail String
  user      User     @relation(fields: [userEmail], references: [email])
}

enum UserType {
  private
  business
}

enum Services {
  receiptManagement
  subscriptionManagement
  invoicing
}

enum RecurringInterval {
  monthly
  quarterly
  yearly
}
